

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <title>xhprof &larr; </title>
  <meta name="author" content="Yan Peipan" />
  <link rel="start" href="/" />
  
  
  
  <!-- syntax highlighting CSS -->
  <link rel="stylesheet" href="/assets/themes/mark-reid/css/syntax.css" type="text/css" />
  <!-- Homepage CSS -->
  <link rel="stylesheet" href="/assets/themes/mark-reid/css/screen.css" type="text/css" />
</head>
<body id="">
  <div id="site">
    <div id="header">
      <h1>
        <a href="/" title="Yan">Yan</a>
        <span class="byline">&larr; <a href="/">Yan Peipan</a></span>
      </h1>
      <ul class="nav">
        <li><a href="/" class="home">Home</a></li>
        <li><a href="/archive.html">Archive</a></li>
        <li><a href="/pages.html">Pages</a></li>
        <li><a href="/categories.html">Categories</a></li>
        <li><a href="/tags.html">Tags</a></li>
      </ul>
    </div>
    

<div id="page">
  <h1 class="emphnext">xhprof</h1>
  <ul class="tag_box inline">
    
    

  
    
    	<li><a href="/tags.html#php-ref">php <span>2</span></a></li>
    
    	<li><a href="/tags.html#xhprof-ref">xhprof <span>1</span></a></li>
    
  



  </ul>
  
<h2 id="克隆代码">克隆代码</h2>

<pre><code>git clone https://github.com/phacility/xhprof.git /var/xhprof XHPROF_HOME
</code></pre>

<h2 id="安装依赖">安装依赖</h2>

<pre><code>pecl install pecl install channel://pecl.php.net/xhprof-0.9.4
</code></pre>

<h2 id="配置phpini">配置php.ini</h2>

<pre><code>extension=xhprof.so
</code></pre>

<h2 id="添加文件-xhprof_homeexamplesprependphp">添加文件 XHPROF_HOME/examples/prepend.php</h2>

<pre><code>xhprof_enable(XHPROF_FLAGS_NO_BUILTINS | XHPROF_FLAGS_CPU | XHPROF_FLAGS_MEMORY);
</code></pre>

<h2 id="添加文件-xhprof_homeexamplesappendphp">添加文件 XHPROF_HOME/examples/append.php</h2>

<pre><code>$xhprof_data = xhprof_disable();
$xhprof_runs = new XHProfRuns_Default();
$run_id = $xhprof_runs-&gt;save_run($xhprof_data, "xhprof_foo");

echo "\n---------------\n".
"http://XHPROF_HOST/index.php?run=$run_id&amp;source=xhprof_foo\n".
"---------------\n";
</code></pre>

<h2 id="配置nginx">配置nginx</h2>

<pre><code>fastcgi_param PHP_VALUE "auto_prepend_file=XHPROF_HOME/examples/prepend.php \n auto_append_file=XHPROF_HOME/examples/append.php";
</code></pre>

  <address class="signature">
    <a class="author" href="/">Yan Peipan</a>
    <span class="date">17 June 2015</span>
    <span class="location"></span>
  </address>
  <div class="prev-next">
    
    <a href="/2016/11/15/coreos.html" class="next" title="CoreOS">Next Post &rarr;</a>
    
    
    <a href="/2015/04/08/%E7%A8%8B%E5%BA%8F%E5%91%98%E9%9D%A2%E8%AF%95%E9%87%91%E5%85%B8.html" class="prev" title="程序员面试金典">&larr; Earlier Post</a>
    
  </div>
</div><!-- End Page -->




    <div id="footer">
      <address>
        <span class="copyright">
          Content by <a href="/sitemap.txt">Yan Peipan</a>.
        </span>
        <span class="engine">
          Powered by <a href="http://github.com/mojombo/jekyll/" title="A static, minimalist CMS">Jekyll</a>
        </span>
      </address>
    </div>
  </div>
  <!--[if IE 6]>
  <script type="text/javascript">
  /*Load jQuery if not already loaded*/ if(typeof jQuery == 'undefined'){ document.write("<script type=\"text/javascript\"   src=\"http://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js\"></"+"script>"); var __noconflict = true; }
  var IE6UPDATE_OPTIONS = {
  icons_path: "http://static.ie6update.com/hosted/ie6update/images/"
}
</script>
<script type="text/javascript" src="http://static.ie6update.com/hosted/ie6update/ie6update.js"></script>
<![endif]-->


</body>
</html>

