"use strict";(self.webpackChunkyanpeipan_github_com=self.webpackChunkyanpeipan_github_com||[]).push([[5195],{2641:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>a,frontMatter:()=>l,metadata:()=>s,toc:()=>u});const s=JSON.parse('{"id":"redis/\u5e38\u89c1\u95ee\u9898/Lettuce\u8fde\u63a5Cluster\u96c6\u7fa4\u5b9e\u4f8b\u65f6\uff0c\u89c4\u683c\u53d8\u66f4\u7684\u5f02\u5e38\u5904\u7406","title":"Lettuce\u8fde\u63a5Cluster\u96c6\u7fa4\u5b9e\u4f8b\u65f6\uff0c\u89c4\u683c\u53d8\u66f4\u7684\u5f02\u5e38\u5904\u7406","description":"\u4f7f\u7528lettuce\u8fde\u63a5Cluster\u96c6\u7fa4\u5b9e\u4f8b\uff0c\u5b9e\u4f8b\u6267\u884c\u89c4\u683c\u53d8\u66f4\u540e\uff0c\u5206\u7247\u6570\u6709\u53d8\u5316\u65f6\uff0c\u90e8\u5206\u69fd\u4f4d\uff08Slot\uff09\u4f1a\u8fc1\u79fb\u5230\u65b0\u5206\u7247\u4e0a\uff0c\u5f53\u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u65b0\u5206\u7247\u65f6\u4f1a\u51fa\u73b0\u4ee5\u4e0b\u5f02\u5e38\u95ee\u9898\uff1a","source":"@site/docs/redis/\u5e38\u89c1\u95ee\u9898/Lettuce\u8fde\u63a5Cluster\u96c6\u7fa4\u5b9e\u4f8b\u65f6\uff0c\u89c4\u683c\u53d8\u66f4\u7684\u5f02\u5e38\u5904\u7406.md","sourceDirName":"redis/\u5e38\u89c1\u95ee\u9898","slug":"/redis/\u5e38\u89c1\u95ee\u9898/Lettuce\u8fde\u63a5Cluster\u96c6\u7fa4\u5b9e\u4f8b\u65f6\uff0c\u89c4\u683c\u53d8\u66f4\u7684\u5f02\u5e38\u5904\u7406","permalink":"/docs/redis/\u5e38\u89c1\u95ee\u9898/Lettuce\u8fde\u63a5Cluster\u96c6\u7fa4\u5b9e\u4f8b\u65f6\uff0c\u89c4\u683c\u53d8\u66f4\u7684\u5f02\u5e38\u5904\u7406","draft":false,"unlisted":false,"editUrl":"https://github.com/yanpeipan/yanpeipan.github.com/tree/main/docs/redis/\u5e38\u89c1\u95ee\u9898/Lettuce\u8fde\u63a5Cluster\u96c6\u7fa4\u5b9e\u4f8b\u65f6\uff0c\u89c4\u683c\u53d8\u66f4\u7684\u5f02\u5e38\u5904\u7406.md","tags":[{"inline":true,"label":"Redis","permalink":"/docs/tags/redis"},{"inline":true,"label":"Lettuce","permalink":"/docs/tags/lettuce"},{"inline":true,"label":"Redis-Cluster","permalink":"/docs/tags/redis-cluster"}],"version":"current","frontMatter":{"title":"Lettuce\u8fde\u63a5Cluster\u96c6\u7fa4\u5b9e\u4f8b\u65f6\uff0c\u89c4\u683c\u53d8\u66f4\u7684\u5f02\u5e38\u5904\u7406","tags":["Redis","Lettuce","Redis-Cluster"]},"sidebar":"redisSidebar","previous":{"title":"Jedis\u8fde\u63a5\u8d85\u65f6\uff1aconnect timed out","permalink":"/docs/redis/\u5e38\u89c1\u95ee\u9898/Jedis\u8fde\u63a5\u8d85\u65f6\uff1aconnect timed out"},"next":{"title":"Lettuce\u95f4\u6b47\u6027\u53d1\u751f\uff1aRedisCommandTimeoutException","permalink":"/docs/redis/\u5e38\u89c1\u95ee\u9898/Lettuce\u95f4\u6b47\u6027\u53d1\u751f\uff1aRedisCommandTimeoutException"}}');var i=n(4848),r=n(8453);const l={title:"Lettuce\u8fde\u63a5Cluster\u96c6\u7fa4\u5b9e\u4f8b\u65f6\uff0c\u89c4\u683c\u53d8\u66f4\u7684\u5f02\u5e38\u5904\u7406",tags:["Redis","Lettuce","Redis-Cluster"]},o="\u95ee\u9898\u73b0\u8c61",c={},u=[{value:"\u65b9\u68481 \u5f00\u542fCluster\u96c6\u7fa4\u81ea\u52a8\u5237\u65b0\u62d3\u6251\u914d\u7f6e\uff08\u63a8\u8350\uff09",id:"\u65b9\u68481-\u5f00\u542fcluster\u96c6\u7fa4\u81ea\u52a8\u5237\u65b0\u62d3\u6251\u914d\u7f6e\u63a8\u8350",level:2},{value:"\u65b9\u68482 \u5173\u95ed\u201c\u9a8c\u8bc1\u96c6\u7fa4\u8282\u70b9\u6210\u5458\u8d44\u683c\u5f00\u5173\u201d",id:"\u65b9\u68482-\u5173\u95ed\u9a8c\u8bc1\u96c6\u7fa4\u8282\u70b9\u6210\u5458\u8d44\u683c\u5f00\u5173",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"\u95ee\u9898\u73b0\u8c61",children:"\u95ee\u9898\u73b0\u8c61"})}),"\n",(0,i.jsx)(t.p,{children:"\u4f7f\u7528lettuce\u8fde\u63a5Cluster\u96c6\u7fa4\u5b9e\u4f8b\uff0c\u5b9e\u4f8b\u6267\u884c\u89c4\u683c\u53d8\u66f4\u540e\uff0c\u5206\u7247\u6570\u6709\u53d8\u5316\u65f6\uff0c\u90e8\u5206\u69fd\u4f4d\uff08Slot\uff09\u4f1a\u8fc1\u79fb\u5230\u65b0\u5206\u7247\u4e0a\uff0c\u5f53\u5ba2\u6237\u7aef\u8fde\u63a5\u5230\u65b0\u5206\u7247\u65f6\u4f1a\u51fa\u73b0\u4ee5\u4e0b\u5f02\u5e38\u95ee\u9898\uff1a"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{children:"java.lang.IllegalArgumentException: Connection to 100.123.70.194:6379 not allowed. This connection point is not known in the cluster view exceptionStackTrace\n"})}),"\n",(0,i.jsxs)(t.p,{children:["\u53c2\u8003Lettuce\u793e\u533a\uff1a",(0,i.jsx)(t.a,{href:"https://github.com/lettuce-io/lettuce-core/issues/731",children:"Connection to X not allowed. This connection point is not known in the cluster view"})]}),"\n",(0,i.jsx)(t.h1,{id:"\u95ee\u9898\u5206\u6790",children:"\u95ee\u9898\u5206\u6790"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.strong,{children:"Cluster\u96c6\u7fa4\u89c4\u683c\u53d8\u66f4\u539f\u7406\uff1a"})}),"\n",(0,i.jsx)(t.p,{children:"\u5ba2\u6237\u7aef\u6839\u636eRESP2\u534f\u8bae\u7684\u5185\u5bb9\uff0c\u542f\u52a8\u540e\u4eceCluster\u96c6\u7fa4\u83b7\u53d6\u8282\u70b9\u62d3\u6251\u4fe1\u606f\uff08Cluster Nodes\uff09\uff0c\u5e76\u5c06\u5176\u62d3\u6251\u5173\u7cfb\u7ef4\u62a4\u5728\u5ba2\u6237\u7aef\u7684\u5185\u5b58\u6570\u636e\u7ed3\u6784\u4e2d\u3002"}),"\n",(0,i.jsx)(t.p,{children:"\u5bf9\u4e8e\u6570\u636e\u8bbf\u95ee\uff0c\u5ba2\u6237\u7aef\u4f1a\u6839\u636eKey\u503c\u6309\u7167CRC16\u7b97\u6cd5\u8fdb\u884cHash\u8ba1\u7b97Slot\u4fe1\u606f\uff0c\u6839\u636e\u5185\u5b58\u4e2d\u4fdd\u5b58\u7684\u8282\u70b9\u62d3\u6251\u5173\u7cfb\u548cSlot\u7684\u5bf9\u5e94\u4fe1\u606f\u8fdb\u884c\u8bf7\u6c42\u81ea\u52a8\u8def\u7531\u3002"}),"\n",(0,i.jsx)(t.p,{children:"\u5728\u6269\u5bb9/\u7f29\u5bb9\u8fc7\u7a0b\u4e2d\uff0c\u5f53\u5b9e\u4f8b\u5206\u7247\u6570\u53d1\u751f\u53d8\u5316\u65f6\uff0c\u5b58\u5728\u8282\u70b9\u62d3\u6251\u5173\u7cfb\u548cSlot\u5bf9\u5e94\u4fe1\u606f\u7684\u53d8\u5316\uff0c\u9700\u8981\u5ba2\u6237\u7aef\u8fdb\u884c\u62d3\u6251\u5173\u7cfb\u7684\u81ea\u52a8\u66f4\u65b0\uff0c\u5426\u5219\u53ef\u80fd\u9020\u6210\u8bf7\u6c42\u8def\u7531\u5931\u8d25\u6216\u8005\u8def\u7531\u4f4d\u7f6e\u9519\u8bef\u7b49\uff0c\u9020\u6210\u5ba2\u6237\u7aef\u8bbf\u95ee\u62a5\u9519\u3002"}),"\n",(0,i.jsx)(t.h1,{id:"\u89e3\u51b3\u65b9\u6848",children:"\u89e3\u51b3\u65b9\u6848"}),"\n",(0,i.jsx)(t.h2,{id:"\u65b9\u68481-\u5f00\u542fcluster\u96c6\u7fa4\u81ea\u52a8\u5237\u65b0\u62d3\u6251\u914d\u7f6e\u63a8\u8350",children:"\u65b9\u68481 \u5f00\u542fCluster\u96c6\u7fa4\u81ea\u52a8\u5237\u65b0\u62d3\u6251\u914d\u7f6e\uff08\u63a8\u8350\uff09"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-java",children:" ClusterTopologyRefreshOptions topologyRefreshOptions = ClusterTopologyRefreshOptions.builder()\n             // \u6bcf\u9694time\u6beb\u79d2\u5468\u671f\u6027\u5237\u65b0\n            .enablePeriodicRefresh(Duration.ofMillis(time))\n\t     // MOVED\u91cd\u5b9a\u5411, ASK\u91cd\u5b9a\u5411, \u91cd\u8fde, \u672a\u77e5\u8282\u70b9(since 5.1), \u69fd\u4f4d\u4e0d\u5728\u5f53\u524d\u6240\u6709\u5206\u7247\u4e2d(since 5.2),\u5f53\u51fa\u73b0\u8fd9\u4e94\u79cd\u60c5\u51b5\u65f6\u4f1a\u89e6\u53d1\u81ea\u9002\u5e94\u5237\u65b0 \n            .enableAllAdaptiveRefreshTriggers()\n            .build();\n\nClusterClientOptions clusterClientOptions = ClusterClientOptions.builder()\n            // Redis\u547d\u4ee4\u8d85\u65f6\u65f6\u95f4, \u8d85\u65f6\u540e\u624d\u4f1a\u4f7f\u7528\u65b0\u7684\u62d3\u6251\u4fe1\u606f\u91cd\u65b0\u5efa\u7acb\u8fde\u63a5\n            .timeoutOptions(TimeoutOptions.enabled(Duration.ofSeconds(timeout)))\n            .topologyRefreshOptions(topologyRefreshOptions)\n            .build();\n"})}),"\n",(0,i.jsx)(t.h2,{id:"\u65b9\u68482-\u5173\u95ed\u9a8c\u8bc1\u96c6\u7fa4\u8282\u70b9\u6210\u5458\u8d44\u683c\u5f00\u5173",children:"\u65b9\u68482 \u5173\u95ed\u201c\u9a8c\u8bc1\u96c6\u7fa4\u8282\u70b9\u6210\u5458\u8d44\u683c\u5f00\u5173\u201d"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-java",children:"ClusterClientOptions clusterClientOptions = ClusterClientOptions.builder()  \n        .validateClusterNodeMembership(false)  \n        .build();\n"})})]})}function a(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>o});var s=n(6540);const i={},r=s.createContext(i);function l(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(r.Provider,{value:t},e.children)}}}]);